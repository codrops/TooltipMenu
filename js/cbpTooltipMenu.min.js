/**
 * cbpTooltipMenu.js v1.0.0
 * http://www.codrops.com
 *
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Copyright 2013, Codrops
 * http://www.codrops.com
 */
(function(e){"use strict";function t(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(){var t=r.clientHeight,n=e.innerHeight;return n>t?n:t}function i(e){return e.getBoundingClientRect()}function o(e,t){if("mouseout"!=e.type&&"mouseover"!=e.type)return!1;for(var n=e.relatedTarget?e.relatedTarget:"mouseout"==e.type?e.toElement:e.fromElement;n&&n!=t;)n=n.parentNode;return n!=t}function s(e,n){this.el=e,this.options=t(this.defaults,n),this._init()}var u=e.document,r=u.documentElement;s.prototype={defaults:{delayMenu:100},_init:function(){this.touch=Modernizr.touch,this.menuItems=u.querySelectorAll("#"+this.el.id+" > li"),this._initEvents()},_initEvents:function(){var e=this;Array.prototype.slice.call(this.menuItems).forEach(function(t){var n=t.querySelector("a");e.touch?n.addEventListener("click",function(t){e._handleClick(this,t)}):(n.addEventListener("click",function(e){this.parentNode.querySelector("ul.cbp-tm-submenu")&&e.preventDefault()}),t.addEventListener("mouseover",function(t){o(t,this)&&e._openMenu(this)}),t.addEventListener("mouseout",function(t){o(t,this)&&e._closeMenu(this)}))})},_openMenu:function(e){var t=this;clearTimeout(this.omtimeout),this.omtimeout=setTimeout(function(){var n=e.querySelector("ul.cbp-tm-submenu");n&&(e.className+=" cbp-tm-show",e.className+="top"===t._positionMenu(e)?" cbp-tm-show-above":" cbp-tm-show-below")},this.touch?0:this.options.delayMenu)},_closeMenu:function(e){clearTimeout(this.omtimeout);var t=e.querySelector("ul.cbp-tm-submenu");t&&(e.className=e.className.replace(RegExp("(^|\\s+)cbp-tm-show(\\s+|$)")," "),e.className=e.className.replace(RegExp("(^|\\s+)cbp-tm-show-below(\\s+|$)")," "),e.className=e.className.replace(RegExp("(^|\\s+)cbp-tm-show-above(\\s+|$)")," "))},_handleClick:function(e,t){var n=e.parentNode,i=Array.prototype.slice.call(this.menuItems),o=n.querySelector("ul.cbp-tm-submenu");if(this.current!==void 0&&i.indexOf(n)!==this.current&&(this._closeMenu(this.el.children[this.current]),this.el.children[this.current].querySelector("ul.cbp-tm-submenu").setAttribute("data-open","false")),o){t.preventDefault();var s=o.getAttribute("data-open");"true"===s?(this._closeMenu(n),o.setAttribute("data-open","false")):(this._openMenu(n),this.current=i.indexOf(n),o.setAttribute("data-open","true"))}},_positionMenu:function(e){var t=n(),o=i(e),s=o.top,u=t-s-e.offsetHeight;return s>=u?"top":"bottom"}},e.cbpTooltipMenu=s})(window);